(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{481:function(a,t,s){"use strict";s.r(t);var e=s(29),r=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"一、概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、概述"}},[a._v("#")]),a._v(" 一、概述")]),a._v(" "),s("p",[a._v("Elasticsearch 是一个分布式的免费开源搜索和分析引擎，适用于包括文本、数字、地理空间、结构化和非结构化数据等在内的所有类型的数据。Elasticsearch 以其简单的 REST 风格 API、分布式特性、速度和可扩展性而闻名，是 Elastic Stack 的核心组件；Elastic Stack 是一套适用于数据采集、扩充、存储、分析和可视化的免费开源工具。人们通常将 Elastic Stack 称为 ELK Stack（代指 Elasticsearch、Logstash 和 Kibana）；")]),a._v(" "),s("h3",{attrs:{id:"elasticsearch-的用途是什么"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-的用途是什么"}},[a._v("#")]),a._v(" Elasticsearch 的用途是什么？")]),a._v(" "),s("p",[a._v("Elasticsearch 在速度和可扩展性方面都表现出色，而且还能够索引多种类型的内容，这意味着其可用于多种用例：")]),a._v(" "),s("ul",[s("li",[a._v("应用程序搜索")]),a._v(" "),s("li",[a._v("网站搜索")]),a._v(" "),s("li",[a._v("企业搜索")]),a._v(" "),s("li",[a._v("日志处理和分析")]),a._v(" "),s("li",[a._v("基础设施指标和容器监测")]),a._v(" "),s("li",[a._v("应用程序性能监测")]),a._v(" "),s("li",[a._v("地理空间数据分析和可视化")]),a._v(" "),s("li",[a._v("安全分析")]),a._v(" "),s("li",[a._v("业务分析")])]),a._v(" "),s("h3",{attrs:{id:"elasticsearch-的优点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-的优点"}},[a._v("#")]),a._v(" Elasticsearch 的优点")]),a._v(" "),s("p",[a._v("**Elasticsearch 很快。**由于 Elasticsearch 是在 Lucene 基础上构建而成的，所以在全文本搜索方面表现十分出色。Elasticsearch 同时还是一个近实时的搜索平台，这意味着从文档索引操作到文档变为可搜索状态之间的延时很短，一般只有一秒。因此，Elasticsearch 非常适用于对时间有严苛要求的用例，例如安全分析和基础设施监测。")]),a._v(" "),s("p",[a._v("**Elasticsearch 具有分布式的本质特征。**Elasticsearch 中存储的文档分布在不同的容器中，这些容器称为"),s("em",[a._v("分片")]),a._v("，可以进行复制以提供数据冗余副本，以防发生硬件故障。Elasticsearch 的分布式特性使得它可以扩展至数百台（甚至数千台）服务器，并处理 PB 量级的数据。")]),a._v(" "),s("p",[a._v("**Elasticsearch 包含一系列广泛的功能。**除了速度、可扩展性和弹性等优势以外，Elasticsearch 还有大量强大的内置功能（例如数据汇总和索引生命周期管理），可以方便用户更加高效地存储和搜索数据。")]),a._v(" "),s("p",[a._v("**Elastic Stack 简化了数据采集、可视化和报告过程。**通过与 Beats 和 Logstash 进行集成，用户能够在向 Elasticsearch 中索引数据之前轻松地处理数据。同时，Kibana 不仅可针对 Elasticsearch 数据提供实时可视化，同时还提供 UI 以便用户快速访问应用程序性能监测 (APM)、日志和基础设施指标等数据。")]),a._v(" "),s("h2",{attrs:{id:"二、工作原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、工作原理"}},[a._v("#")]),a._v(" 二、工作原理")]),a._v(" "),s("p",[a._v("原始数据会从多个来源（包括日志、系统指标和网络应用程序）输入到 Elasticsearch 中。"),s("em",[a._v("数据采集")]),a._v("指在 Elasticsearch 中进行"),s("em",[a._v("索引")]),a._v("之前解析、标准化并充实这些原始数据的过程。这些数据在 Elasticsearch 中索引完成之后，用户便可针对他们的数据运行复杂的查询，并使用聚合来检索自身数据的复杂汇总。")]),a._v(" "),s("h3",{attrs:{id:"elasticsearch-索引是什么"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-索引是什么"}},[a._v("#")]),a._v(" Elasticsearch 索引是什么？")]),a._v(" "),s("p",[a._v("Elasticsearch "),s("em",[a._v("索引")]),a._v("指相互关联的文档集合。Elasticsearch 会以 JSON 文档的形式存储数据。每个文档都会在一组"),s("em",[a._v("键")]),a._v("（字段或属性的名称）和它们对应的值（字符串、数字、布尔值、日期、"),s("em",[a._v("数值")]),a._v("组、地理位置或其他类型的数据）之间建立联系。")]),a._v(" "),s("p",[a._v("Elasticsearch 使用的是一种名为"),s("em",[a._v("倒排索引")]),a._v("的数据结构，这一结构的设计可以允许十分快速地进行全文本搜索。倒排索引会列出在所有文档中出现的每个特有词汇，并且可以找到包含每个词汇的全部文档。")]),a._v(" "),s("p",[a._v("在索引过程中，Elasticsearch 会存储文档并构建倒排索引，这样用户便可以近实时地对文档数据进行搜索。索引过程是在索引 API 中启动的，通过此 API 您既可向特定索引中添加 JSON 文档，也可更改特定索引中的 JSON 文档。")]),a._v(" "),s("h2",{attrs:{id:"三、安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、安装"}},[a._v("#")]),a._v(" 三、安装")]),a._v(" "),s("p",[a._v("这里以在 docker 中拉取镜像为例")]),a._v(" "),s("h3",{attrs:{id:"_3-1-基本安装运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-基本安装运行"}},[a._v("#")]),a._v(" 3.1 基本安装运行")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 1、拉取镜像")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" pull elasticsearch:7.17.2   \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 2、创建存放数据及配置文件的文件夹，启动时挂载。")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" -p  /Library/elasticsearch/data/ \n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" -p  /Library/elasticsearch/config/\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 3、编写配置文件")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'http.host: 0.0.0.0\nhttp.cors.enabled: true\nhttp.cors.allow-origin: \"*\" '")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),a._v("/Library/elasticsearch/config/elasticsearch.yml\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v('# http.cors.enabled: true 和http.cors.allow-origin: "*"配置是为了解决跨域问题，因为等下还要下载可视化工具查看。')]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 4、修改文件夹的权限")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" -R "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("777")]),a._v(" /Users/aafall/Documents/docker/es\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 5、使用镜像，创建容器并启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run -d --name elasticsearch -p "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9200")]),a._v(":9200 -p "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9300")]),a._v(":9300 -e "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"discovery.type=single-node"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-e "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ES_JAVA_OPTS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"-Xms64m -Xmx512m"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-v /Users/aafall/Documents/docker/es/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-v /Users/aafall/Documents/docker/es/data:/usr/share/elasticsearch/data "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-v /Users/aafall/Documents/docker/es/plugins:/usr/share/elasticsearch/plugins "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\nelasticsearch:7.17.2\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# -d 后台运行容器，返回容器ID")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v('# -e ES_JAVA_OPTS="-Xms64m -Xmx512m" 配置内存大小')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v('# -e "discovery.type=single-node" 单例模式')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# -v 目录的映射")]),a._v("\n")])])]),s("h3",{attrs:{id:"_3-2-安装-ik-分词器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-安装-ik-分词器"}},[a._v("#")]),a._v(" 3.2 安装 IK 分词器")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("在线安装")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入容器")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" -it elasticsearch /bin/bash  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 安装对应版本")]),a._v("\n./bin/elasticsearch-plugin "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.17.2/elasticsearch-analysis-ik-7.17.2.zip\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# https://github.com/medcl/elasticsearch-analysis-ik/releases")]),a._v("\n")])])])]),a._v(" "),s("li",[s("p",[a._v("离线安装")])])]),a._v(" "),s("h2",{attrs:{id:"四、连接方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、连接方式"}},[a._v("#")]),a._v(" 四、连接方式")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("transport ：通过 TCP 方式访问 ES 。")]),a._v(" "),s("blockquote",[s("p",[a._v("对应的库是 "),s("a",{attrs:{href:"https://mvnrepository.com/artifact/org.elasticsearch.client/transport",target:"_blank",rel:"noopener noreferrer"}},[s("code",[a._v("org.elasticsearch.client.transport")]),s("OutboundLink")],1),a._v(" 。")])])]),a._v(" "),s("li",[s("p",[a._v("rest ：通过 HTTP API 方式访问 ES 。")]),a._v(" "),s("blockquote",[s("p",[a._v("对应的库是：")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://mvnrepository.com/artifact/org.elasticsearch.client/elasticsearch-rest-client",target:"_blank",rel:"noopener noreferrer"}},[s("code",[a._v("elasticsearch-rest-client")]),s("OutboundLink")],1),a._v(" + "),s("a",{attrs:{href:"https://mvnrepository.com/artifact/org.elasticsearch.client/elasticsearch-rest-client",target:"_blank",rel:"noopener noreferrer"}},[s("code",[a._v("org.elasticsearch.client.rest")]),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://mvnrepository.com/artifact/org.elasticsearch.client/elasticsearch-rest-high-level-client",target:"_blank",rel:"noopener noreferrer"}},[s("code",[a._v("elasticsearch-rest-high-level-client")]),s("OutboundLink")],1),a._v(" ，提供 "),s("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("high-level rest"),s("OutboundLink")],1),a._v(" API 。从 Elasticsearch 6.0.0-beta1 开始提供。")])])])])]),a._v(" "),s("p",[a._v("我们在项目中，编写数据库操作的逻辑，使用 MyBatis 或者 JPA 为主，而不使用原生的 JDBC 。那么，我们在编写 Elasticsearch 操作的逻辑，也不"),s("strong",[a._v("直接")]),a._v("使用上述的客户端，而是：")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://spring.io/projects/spring-data-elasticsearch",target:"_blank",rel:"noopener noreferrer"}},[s("code",[a._v("spring-data-elasticsearch")]),s("OutboundLink")],1),a._v(" ，基于 Elasticsearch transport 客户端封装。")]),a._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/VanRoy/spring-data-jest",target:"_blank",rel:"noopener noreferrer"}},[s("code",[a._v("spring-data-jest")]),s("OutboundLink")],1),a._v(" ，基于 Jest 客户端封装。")])]),a._v(" "),s("p",[a._v("虽然这两者底层使用的不同客户端，但是都基于 "),s("a",{attrs:{href:"https://spring.io/projects/spring-data",target:"_blank",rel:"noopener noreferrer"}},[a._v("Spring Data"),s("OutboundLink")],1),a._v(" 体系，所以项目在使用时，编写的代码是相同的。")]),a._v(" "),s("h3",{attrs:{id:"_4-1-spring-data-jest"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-spring-data-jest"}},[a._v("#")]),a._v(" 4.1 Spring Data Jest")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("引入依赖")]),a._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("\x3c!-- 自动化配置 Spring Data Jest --\x3e")]),a._v("\n "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n     "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("com.github.vanroy"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n     "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("spring-boot-starter-data-jest"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n     "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("3.2.5.RELEASE"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])])])])]),a._v(" "),s("h3",{attrs:{id:"_4-2-spring-data-elasticsearch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-spring-data-elasticsearch"}},[a._v("#")]),a._v(" 4.2 Spring Data Elasticsearch")])])}),[],!1,null,null,null);t.default=r.exports}}]);